id: nxc_password_spray
name: NetExec Password Spray
category: nxc
description: "Teste un mot de passe sur une liste d'utilisateurs via SMB."
checklist_keys: ["pass_spray"] 
inputs:
  - name: target
    label: "Cible (IP/CIDR)"
    placeholder: 10.3.10.0/24
    default: 10.3.10.0/24
  - name: user_file
    label: "Fichier Utilisateurs"
    placeholder: /workspace/users.txt
    default: /workspace/users.txt
  - name: password
    label: "Mot de passe √† tester"
    placeholder: Winter2025!

command: "nxc smb {{target}} -u {{user_file}} -p '{{password}}' --continue-on-success"

parsing:
  mode: "text"
  
  rules:
    - name: "Compte Compromis"
      regex: "\\[\\+\\](?!.*\\(Pwn3d\\))" 
      badge: "üî¥ [CRITIQUE]"

    - name: "Admin Local (Pwn3d!)"
      regex: "\\(admin!)\\)"
      badge: "üî¥ [CRITIQUE]"

    - name: "Doit changer MDP"
      regex: "STATUS_PASSWORD_MUST_CHANGE"
      badge: "‚ö†Ô∏è [CHANGE PWD]"