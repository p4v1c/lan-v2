id: ldeep_domain_policy
name: LDEEP Domain Policy
category: Enum√©ration
description: ""
inputs:
  - name: domain
    label: "Domaine"
    placeholder: north.sevenkingdoms.local
  - name: dc_ip
    label: "IP du DC"
    placeholder: 10.3.10.11
  - name: username
    label: Utilisateur
    placeholder: user
  - name: password
    label: Mot de passe
    placeholder: password
command: "ldeep ldap -s ldap://{{dc_ip}} -d {{domain}} -u '{{username}}' -p '{{password}}' domain_policy"

parsing:
  mode: "text" 
  
  rules:
    
    - name: "MAQ Vuln√©rable (Par d√©faut)"
      regex: "ms-DS-MachineAccountQuota:\\s*10"
      badge: "‚ö†Ô∏è [MAQ=10]"

    - name: "Pas de Verrouillage Compte"
      regex: "lockoutThreshold:\\s*0"
      badge: "üî¥ [NO LOCKOUT]"


    - name: "Niveau Fonctionnel"
      regex: "msDS-Behavior-Version: .+"
      badge: "‚ÑπÔ∏è [VERSION]"

    - name: "Politique Mot de Passe"
      regex: "minPwdLength: .+"
      badge: "üîë [PWD MIN]"

    - name: "Historique Mots de Passe"
      regex: "pwdHistoryLength: .+"
      badge: "Hz [HISTORY]"

    - name: "Seuil de Blocage"
      regex: "lockoutThreshold: [1-9].*"
      badge: "üîí [LOCKOUT]"

    - name: "Dur√©e Blocage"
      regex: "lockoutDuration: .+"
      badge: "‚è±Ô∏è [TIME]"