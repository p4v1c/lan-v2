id: nxc_ldap_checker
name: NetExec LDAP Security
category: Enum√©ration
description: "V√©rifie la s√©curit√© LDAP (Signing & Channel Binding) via le banner standard."
checklist_keys: ["sec_ldap"]    # <--- AJOUTER ICI
inputs:
  - name: target
    label: IP du DC
    placeholder: 10.3.10.11
  - name: username
    label: Utilisateur
    placeholder: guest
  - name: password
    label: Mot de passe
    placeholder: password
command: "nxc ldap {{target}} -u '{{username}}' -p '{{password}}'"

parsing:
  mode: "text"
  # Regex IP standard
  ip_extract: "\\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  
  rules:
    - name: "LDAP Signing NON Forc√© (Relay Possible)"
      regex: "signing:(False|None)"
      badge: "üî¥ [CRITIQUE]"
      
    - name: "LDAP Signing Forc√©"
      regex: "signing:True"
      badge: "‚úÖ [OK]"

    # CHANNEL BINDING
    - name: "Channel Binding D√©sactiv√©"
      regex: "channel binding:Never"
      badge: "üü† [RISQUE]"
      
    - name: "Channel Binding Activ√©"
      regex: "channel binding:True"
      badge: "‚úÖ [OK]"