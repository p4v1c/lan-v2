id: nxc_smb_security
name: SMB Security (v1 & Signing)
category: EnumÃ©ration
description: "VÃ©rifie SMBv1 (Dangereux) et SMB Signing (Relay)."
checklist_keys: ["sec_smb"]
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur
    placeholder: guest
  - name: password
    label: Mot de passe
    placeholder: password
command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}'"

parsing:
  mode: "text" # NOUVEAU MODE
  ip_extract: "\\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  
  rules:
    - name: "SMB Signing DÃ©sactivÃ© (Relay Possible !)"
      regex: "signing:False"
      badge: "ðŸ”´ [DANGER]"
    
    - name: "SMB Signing ActivÃ© (Safe)"
      regex: "signing:True"
      badge: "âœ… [OK]"

    - name: "SMBv1 ActivÃ© (EternalBlue ?)"
      regex: "SMBv1:True"
      badge: "ðŸ”´ [CRITIQUE]"
      
    - name: "SMBv1 DÃ©sactivÃ©"
      regex: "SMBv1:False"
      badge: "âœ… [OK]"