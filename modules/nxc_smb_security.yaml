id: nxc_smb_security
name: SMB Security (v1 & Signing)
category: Enum√©ration
description: "V√©rifie SMBv1 (Dangereux) et SMB Signing (Relay)."
checklist_keys: ["sec_smb"]     # <--- AJOUTER ICI
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur
    placeholder: guest
  - name: password
    label: Mot de passe
    placeholder: password
command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}'"

parsing:
  mode: "text" # NOUVEAU MODE
  ip_extract: "\\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  
  rules:
    - name: "SMB Signing D√©sactiv√© (Relay Possible !)"
      regex: "signing:False"
      badge: "üî¥ [DANGER]"
    
    - name: "SMB Signing Activ√© (Safe)"
      regex: "signing:True"
      badge: "‚úÖ [OK]"

    - name: "SMBv1 Activ√© (EternalBlue ?)"
      regex: "SMBv1:True"
      badge: "üî¥ [CRITIQUE]"
      
    - name: "SMBv1 D√©sactiv√©"
      regex: "SMBv1:False"
      badge: "‚úÖ [OK]"