id: all_in_one_enum
name: All-in-One Enumeration
category: auto
description: "Combine several enumeration and no-auth scans."
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur (facultatif)
    placeholder: guest
    default: ""
  - name: password
    label: Mot de passe (facultatif)
    placeholder: password
    default: ""
  - name: dc_ip
    label: IP du DC (pour LDAP, facultatif)
    placeholder: 10.3.10.11
    default: ""

steps:  
  - name: SMB Security (v1 & Signing)
    command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}'"

  - name: Anonymous SMB Shares
    command: "nxc smb {{target}} -u '' -p '' --shares" 

  - name: SSH Default Creds
    command: "nxc ssh {{target}} -u root admin user -p root admin password user 123456"

  - name: FTP Anonymous
    command: "nxc ftp {{target}} -u 'anonymous' -p 'anonymous'"

  - name: LDAP Anonymous Bind
    command: "nxc ldap {{target}} -u '' -p ''"

  - name: LDAP Security
    command: "nxc ldap {{target}} -u '{{username}}' -p '{{password}}'"
