id: all_in_one_enum
name: All-in-One Enumeration
category: auto
checklist_keys: ["anon_ftp","anon_smb","anon_ssh","anon_ldap","sec_smb","sec_ldap"]
description: "Combine several enumeration and no-auth scans."
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur (facultatif)
    placeholder: guest
    default: ""
  - name: password
    label: Mot de passe (facultatif)
    placeholder: password
    default: ""
  - name: dc_ip
    label: IP du DC (pour LDAP, facultatif)
    placeholder: 10.3.10.11
    default: ""

steps:  
  - name: SMB Security (v1 & Signing)
    command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}'"

  - name: Anonymous SMB Shares
    command: "nxc smb {{target}} -u '' -p '' --shares" 

  - name: SSH Default Creds
    command: "nxc ssh {{target}} -u root admin user -p root admin password user 123456"

  - name: FTP Anonymous
    command: "nxc ftp {{target}} -u 'anonymous' -p 'anonymous'"

  - name: LDAP Anonymous Bind
    command: "nxc ldap {{target}} -u '' -p ''"

  - name: LDAP Security
    command: "nxc ldap {{target}} -u '{{username}}' -p '{{password}}'"

parsing:
  mode: "text"
  save_results: true
  ip_extract: '\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b'
  rules:
    - name: "SMB Signing DÃ©sactivÃ© (Relay Possible !)"
      regex: "SMB.*signing:False"
      badge: "ðŸ”´ [DANGER]"
    - name: "SMBv1 ActivÃ© (EternalBlue ?)"
      regex: "SMB.*SMBv1:True"
      badge: "ðŸ”´ [CRITIQUE]"
    - name: "Partage Writable (R/W)"
      regex: "SMB.*READ,WRITE"
      badge: "ðŸ”´ [DANGER]"
    - name: "Null Session ActivÃ©e"
      regex: "SMB.*Null Auth:True"
      badge: "ðŸŸ  [RISQUE]"
    - name: "Compte SSH Compromis"
      regex: 'SSH.*\[\+\]'
      badge: "ðŸ”´ [CRITIQUE]"
    - name: "FTP Anonyme ActivÃ©"
      regex: 'FTP.*\[\+\]'
      badge: "ðŸŸ  [MOYEN]"
    - name: "LDAP Null Bind (Anonyme)"
      regex: 'LDAP.*\[\+\]'
      badge: "ðŸŸ  [MOYEN]"
    - name: "LDAP Signing NON ForcÃ© (Relay Possible)"
      regex: "LDAP.*signing:(False|None)"
      badge: "ðŸ”´ [CRITIQUE]"
    - name: "Channel Binding DÃ©sactivÃ©"
      regex: "LDAP.*channel binding:Never"
      badge: "ðŸŸ  [RISQUE]"
