id: nxc
name: NetExec (SMB Shares)
category: nxc
description: "Scan des partages SMB, des permissions et des accÃ¨s."
checklist_keys: ["smb_shares", "anon_smb"]
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur
    placeholder: guest
  - name: password
    label: Mot de passe
    placeholder: password
command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}' --shares"

parsing:
  mode: "text"
  ip_extract: "\\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  
  rules:
    - name: "Partage Writable (R/W)"
      regex: "READ,WRITE"
      badge: "ðŸ”´ [DANGER]"

    - name: "Partage Readable"
      regex: "\\sREAD(?!,WRITE)"
      badge: "ðŸ”µ [INFO]"

    # 3. AccÃ¨s Null Session (Anonyme)
    - name: "Null Session ActivÃ©e"
      regex: "Null Auth:True"
      badge: "ðŸŸ  [RISQUE]"