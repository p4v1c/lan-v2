id: nxc
name: NetExec (SMB Shares)
category: EnumÃ©ration
description: "Scan des partages SMB, des permissions et des accÃ¨s."
checklist_keys: ["smb_shares", "anon_smb"]
inputs:
  - name: target
    label: Cible (IP/CIDR)
    placeholder: 10.3.10.0/24
  - name: username
    label: Utilisateur
    placeholder: guest
  - name: password
    label: Mot de passe
    placeholder: password
command: "nxc smb {{target}} -u '{{username}}' -p '{{password}}' --shares"

parsing:
  mode: "text"
  # On extrait l'IP prÃ©sente au dÃ©but de chaque ligne NetExec
  ip_extract: "\\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  
  rules:
    # 1. Partage en Lecture ET Ã‰criture (Dangereux)
    - name: "Partage Writable (R/W)"
      regex: "READ,WRITE"
      badge: "ðŸ”´ [DANGER]"

    # 2. Partage en Lecture Seule (Infos)
    # Regex: Cherche "READ" mais QUI N'EST PAS suivi de ",WRITE" (Negative Lookahead)
    - name: "Partage Readable"
      regex: "\\sREAD(?!,WRITE)"
      badge: "ðŸ”µ [INFO]"

    # 3. AccÃ¨s Null Session (Anonyme)
    - name: "Null Session ActivÃ©e"
      regex: "Null Auth:True"
      badge: "ðŸŸ  [RISQUE]"