id: ldeep_pkis
name: LDEEP PKI & Certs
category: Enum√©ration
description: ""
inputs:
  - name: dc_ip
    label: IP du DC
    placeholder: 10.10.10.10
  - name: domain
    label: Domaine
    placeholder: domain.local
  - name: username
    label: Utilisateur
    placeholder: user
  - name: password
    label: Mot de passe
    placeholder: password
command: "ldeep ldap -s ldap://{{dc_ip}} -d {{domain}} -u '{{username}}' -p '{{password}}' pkis -v"

parsing:
  mode: "json"
  save_results: true
  key_ip: "name" 
  
  rules:
    - condition_key: "objectClass"
      condition_value: "pKIEnrollmentService"
      badge: "üõ°Ô∏è [PKI SERVER]"

    - condition_key: "objectClass"
      condition_value: "pKICertificateTemplate"
      badge: "üìÑ [TEMPLATE]"

  fields:
    - "dNSHostName"          
    - "cACertificateDN"      
    - "certificateTemplates" 
    - "whenCreated"          